// koffee 1.4.0
var Action, Gate, Light, Material, Switch, Vector,
    extend = function(child, parent) { for (var key in parent) { if (hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; },
    hasProp = {}.hasOwnProperty;

Vector = require('./lib/vector');

Switch = require('./switch');

Light = require('./light');

Action = require('./action');

Material = require('./material');

Gate = (function(superClass) {
    extend(Gate, superClass);

    Gate.prototype.isSpaceEgoistic = function() {
        return false;
    };

    function Gate(active) {
        Gate.__super__.constructor.apply(this, arguments);
        this.ENTER_EVENT = this.addEventWithName("enter");
        this.value = 0.0;
        this.getActionWithId(Action.ROTATE).duration = 50000;
        this.sound_on = 'GATE_OPEN';
        this.sound_off = 'GATE_CLOSE';
    }

    Gate.prototype.createLight = function() {
        if (this.light) {
            return;
        }
        return this.light = new Light({
            pos: this.position,
            radius: 10.0,
            shadow: true
        });
    };

    Gate.prototype.createMesh = function() {
        var t1, t2, t3, torusRadius;
        torusRadius = 0.05;
        t1 = new THREE.TorusBufferGeometry(0.5 - torusRadius, torusRadius, 16, 32);
        this.mesh = new THREE.Mesh(t1, Material.gate);
        this.mesh.castShadow = true;
        this.mesh.receiveShadow = true;
        t2 = new THREE.TorusGeometry(0.5 - torusRadius, torusRadius, 16, 32);
        t3 = new THREE.TorusGeometry(0.5 - torusRadius, torusRadius, 16, 32);
        t2.rotateY(Vector.DEG2RAD(90));
        t3.rotateX(Vector.DEG2RAD(90));
        t2.merge(t3);
        t3.dispose();
        this.tors = new THREE.Mesh(t2, Material.gate);
        this.tors.castShadow = true;
        this.tors.receiveShadow = true;
        this.mesh.add(this.tors);
        this.mesh.castShadow = true;
        this.mesh.receiveShadow = true;
        return this.mesh;
    };

    Gate.prototype.bulletImpact = function() {};

    Gate.prototype.newCellMate = function(object) {
        if (object.name === 'player' && this.active) {
            world.playSound('GATE_WARP');
            this.events[this.ENTER_EVENT].triggerActions();
            return this.active = false;
        }
    };

    return Gate;

})(Switch);

module.exports = Gate;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZ2F0ZS5qcyIsInNvdXJjZVJvb3QiOiIuIiwic291cmNlcyI6WyIiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQU1BLElBQUEsNkNBQUE7SUFBQTs7O0FBQUEsTUFBQSxHQUFXLE9BQUEsQ0FBUSxjQUFSOztBQUNYLE1BQUEsR0FBVyxPQUFBLENBQVEsVUFBUjs7QUFDWCxLQUFBLEdBQVcsT0FBQSxDQUFRLFNBQVI7O0FBQ1gsTUFBQSxHQUFXLE9BQUEsQ0FBUSxVQUFSOztBQUNYLFFBQUEsR0FBVyxPQUFBLENBQVEsWUFBUjs7QUFFTDs7O21CQUVGLGVBQUEsR0FBaUIsU0FBQTtlQUFHO0lBQUg7O0lBRWQsY0FBQyxNQUFEO1FBRUMsdUNBQUEsU0FBQTtRQUVBLElBQUMsQ0FBQSxXQUFELEdBQWUsSUFBQyxDQUFBLGdCQUFELENBQWtCLE9BQWxCO1FBQ2YsSUFBQyxDQUFBLEtBQUQsR0FBUztRQUNULElBQUMsQ0FBQSxlQUFELENBQWlCLE1BQU0sQ0FBQyxNQUF4QixDQUErQixDQUFDLFFBQWhDLEdBQTJDO1FBQzNDLElBQUMsQ0FBQSxRQUFELEdBQWE7UUFDYixJQUFDLENBQUEsU0FBRCxHQUFhO0lBUmQ7O21CQVVILFdBQUEsR0FBYSxTQUFBO1FBRVQsSUFBVSxJQUFDLENBQUEsS0FBWDtBQUFBLG1CQUFBOztlQUVBLElBQUMsQ0FBQSxLQUFELEdBQVMsSUFBSSxLQUFKLENBQ0w7WUFBQSxHQUFBLEVBQVEsSUFBQyxDQUFBLFFBQVQ7WUFDQSxNQUFBLEVBQVEsSUFEUjtZQUVBLE1BQUEsRUFBUSxJQUZSO1NBREs7SUFKQTs7bUJBZ0JiLFVBQUEsR0FBWSxTQUFBO0FBRVIsWUFBQTtRQUFBLFdBQUEsR0FBYztRQUNkLEVBQUEsR0FBSyxJQUFJLEtBQUssQ0FBQyxtQkFBVixDQUE4QixHQUFBLEdBQUksV0FBbEMsRUFBK0MsV0FBL0MsRUFBNEQsRUFBNUQsRUFBZ0UsRUFBaEU7UUFFTCxJQUFDLENBQUEsSUFBRCxHQUFRLElBQUksS0FBSyxDQUFDLElBQVYsQ0FBZSxFQUFmLEVBQW1CLFFBQVEsQ0FBQyxJQUE1QjtRQUNSLElBQUMsQ0FBQSxJQUFJLENBQUMsVUFBTixHQUFtQjtRQUNuQixJQUFDLENBQUEsSUFBSSxDQUFDLGFBQU4sR0FBc0I7UUFFdEIsRUFBQSxHQUFLLElBQUksS0FBSyxDQUFDLGFBQVYsQ0FBd0IsR0FBQSxHQUFJLFdBQTVCLEVBQXlDLFdBQXpDLEVBQXNELEVBQXRELEVBQTBELEVBQTFEO1FBQ0wsRUFBQSxHQUFLLElBQUksS0FBSyxDQUFDLGFBQVYsQ0FBd0IsR0FBQSxHQUFJLFdBQTVCLEVBQXlDLFdBQXpDLEVBQXNELEVBQXRELEVBQTBELEVBQTFEO1FBQ0wsRUFBRSxDQUFDLE9BQUgsQ0FBVyxNQUFNLENBQUMsT0FBUCxDQUFlLEVBQWYsQ0FBWDtRQUNBLEVBQUUsQ0FBQyxPQUFILENBQVcsTUFBTSxDQUFDLE9BQVAsQ0FBZSxFQUFmLENBQVg7UUFDQSxFQUFFLENBQUMsS0FBSCxDQUFTLEVBQVQ7UUFDQSxFQUFFLENBQUMsT0FBSCxDQUFBO1FBQ0EsSUFBQyxDQUFBLElBQUQsR0FBUSxJQUFJLEtBQUssQ0FBQyxJQUFWLENBQWUsRUFBZixFQUFtQixRQUFRLENBQUMsSUFBNUI7UUFDUixJQUFDLENBQUEsSUFBSSxDQUFDLFVBQU4sR0FBbUI7UUFDbkIsSUFBQyxDQUFBLElBQUksQ0FBQyxhQUFOLEdBQXNCO1FBQ3RCLElBQUMsQ0FBQSxJQUFJLENBQUMsR0FBTixDQUFVLElBQUMsQ0FBQSxJQUFYO1FBQ0EsSUFBQyxDQUFBLElBQUksQ0FBQyxVQUFOLEdBQW1CO1FBQ25CLElBQUMsQ0FBQSxJQUFJLENBQUMsYUFBTixHQUFzQjtlQUN0QixJQUFDLENBQUE7SUFyQk87O21CQXVCWixZQUFBLEdBQWMsU0FBQSxHQUFBOzttQkFFZCxXQUFBLEdBQWEsU0FBQyxNQUFEO1FBRVQsSUFBRyxNQUFNLENBQUMsSUFBUCxLQUFlLFFBQWYsSUFBNEIsSUFBQyxDQUFBLE1BQWhDO1lBQ0ksS0FBSyxDQUFDLFNBQU4sQ0FBZ0IsV0FBaEI7WUFDQSxJQUFDLENBQUEsTUFBTyxDQUFBLElBQUMsQ0FBQSxXQUFELENBQWEsQ0FBQyxjQUF0QixDQUFBO21CQUNBLElBQUMsQ0FBQSxNQUFELEdBQVUsTUFIZDs7SUFGUzs7OztHQXZERTs7QUE4RG5CLE1BQU0sQ0FBQyxPQUFQLEdBQWlCIiwic291cmNlc0NvbnRlbnQiOlsiIyAgMDAwMDAwMCAgICAwMDAwMDAwICAgMDAwMDAwMDAwICAwMDAwMDAwMFxuIyAwMDAgICAgICAgIDAwMCAgIDAwMCAgICAgMDAwICAgICAwMDAgICAgIFxuIyAwMDAgIDAwMDAgIDAwMDAwMDAwMCAgICAgMDAwICAgICAwMDAwMDAwIFxuIyAwMDAgICAwMDAgIDAwMCAgIDAwMCAgICAgMDAwICAgICAwMDAgICAgIFxuIyAgMDAwMDAwMCAgIDAwMCAgIDAwMCAgICAgMDAwICAgICAwMDAwMDAwMFxuXG5WZWN0b3IgICA9IHJlcXVpcmUgJy4vbGliL3ZlY3RvcidcblN3aXRjaCAgID0gcmVxdWlyZSAnLi9zd2l0Y2gnXG5MaWdodCAgICA9IHJlcXVpcmUgJy4vbGlnaHQnXG5BY3Rpb24gICA9IHJlcXVpcmUgJy4vYWN0aW9uJ1xuTWF0ZXJpYWwgPSByZXF1aXJlICcuL21hdGVyaWFsJ1xuXG5jbGFzcyBHYXRlIGV4dGVuZHMgU3dpdGNoXG4gICAgXG4gICAgaXNTcGFjZUVnb2lzdGljOiAtPiBmYWxzZVxuXG4gICAgQDogKGFjdGl2ZSkgLT5cbiAgICAgICAgXG4gICAgICAgIHN1cGVyXG4gICAgICAgIFxuICAgICAgICBARU5URVJfRVZFTlQgPSBAYWRkRXZlbnRXaXRoTmFtZSBcImVudGVyXCJcbiAgICAgICAgQHZhbHVlID0gMC4wXG4gICAgICAgIEBnZXRBY3Rpb25XaXRoSWQoQWN0aW9uLlJPVEFURSkuZHVyYXRpb24gPSA1MDAwMCBcbiAgICAgICAgQHNvdW5kX29uICA9ICdHQVRFX09QRU4nXG4gICAgICAgIEBzb3VuZF9vZmYgPSAnR0FURV9DTE9TRSdcblxuICAgIGNyZWF0ZUxpZ2h0OiAtPiBcbiAgICAgICAgXG4gICAgICAgIHJldHVybiBpZiBAbGlnaHQgXG4gICAgICAgICAgICBcbiAgICAgICAgQGxpZ2h0ID0gbmV3IExpZ2h0IFxuICAgICAgICAgICAgcG9zOiAgICBAcG9zaXRpb25cbiAgICAgICAgICAgIHJhZGl1czogMTAuMFxuICAgICAgICAgICAgc2hhZG93OiB0cnVlXG4gICAgICAgICAgICBcbiAgICAjIGRlbDogLT5cbiMgICAgICAgICBcbiAgICAgICAgIyBAdG9ycy5nZW9tZXRyeS5kaXNwb3NlKClcbiAgICAgICAgIyBAbWVzaC5nZW9tZXRyeS5kaXNwb3NlKClcbiAgICAgICAgIyBAbGlnaHQ/LmRlbCgpXG4gICAgICAgICMgc3VwZXJcbiAgICAgICAgICAgIFxuICAgIGNyZWF0ZU1lc2g6IC0+IFxuICAgICAgICBcbiAgICAgICAgdG9ydXNSYWRpdXMgPSAwLjA1XG4gICAgICAgIHQxID0gbmV3IFRIUkVFLlRvcnVzQnVmZmVyR2VvbWV0cnkgMC41LXRvcnVzUmFkaXVzLCB0b3J1c1JhZGl1cywgMTYsIDMyXG4gICAgICAgICAgICBcbiAgICAgICAgQG1lc2ggPSBuZXcgVEhSRUUuTWVzaCB0MSwgTWF0ZXJpYWwuZ2F0ZVxuICAgICAgICBAbWVzaC5jYXN0U2hhZG93ID0gdHJ1ZVxuICAgICAgICBAbWVzaC5yZWNlaXZlU2hhZG93ID0gdHJ1ZVxuICAgICAgICBcbiAgICAgICAgdDIgPSBuZXcgVEhSRUUuVG9ydXNHZW9tZXRyeSAwLjUtdG9ydXNSYWRpdXMsIHRvcnVzUmFkaXVzLCAxNiwgMzJcbiAgICAgICAgdDMgPSBuZXcgVEhSRUUuVG9ydXNHZW9tZXRyeSAwLjUtdG9ydXNSYWRpdXMsIHRvcnVzUmFkaXVzLCAxNiwgMzJcbiAgICAgICAgdDIucm90YXRlWSBWZWN0b3IuREVHMlJBRCA5MCBcbiAgICAgICAgdDMucm90YXRlWCBWZWN0b3IuREVHMlJBRCA5MCBcbiAgICAgICAgdDIubWVyZ2UgdDNcbiAgICAgICAgdDMuZGlzcG9zZSgpXG4gICAgICAgIEB0b3JzID0gbmV3IFRIUkVFLk1lc2ggdDIsIE1hdGVyaWFsLmdhdGVcbiAgICAgICAgQHRvcnMuY2FzdFNoYWRvdyA9IHRydWVcbiAgICAgICAgQHRvcnMucmVjZWl2ZVNoYWRvdyA9IHRydWVcbiAgICAgICAgQG1lc2guYWRkIEB0b3JzXG4gICAgICAgIEBtZXNoLmNhc3RTaGFkb3cgPSB0cnVlXG4gICAgICAgIEBtZXNoLnJlY2VpdmVTaGFkb3cgPSB0cnVlXG4gICAgICAgIEBtZXNoXG4gICAgXG4gICAgYnVsbGV0SW1wYWN0OiAtPlxuXG4gICAgbmV3Q2VsbE1hdGU6IChvYmplY3QpIC0+XG4gICAgICAgIFxuICAgICAgICBpZiBvYmplY3QubmFtZSA9PSAncGxheWVyJyBhbmQgQGFjdGl2ZVxuICAgICAgICAgICAgd29ybGQucGxheVNvdW5kICdHQVRFX1dBUlAnXG4gICAgICAgICAgICBAZXZlbnRzW0BFTlRFUl9FVkVOVF0udHJpZ2dlckFjdGlvbnMoKSBcbiAgICAgICAgICAgIEBhY3RpdmUgPSBmYWxzZVxuICAgICAgICAgICAgICAgIFxubW9kdWxlLmV4cG9ydHMgPSBHYXRlXG4iXX0=
//# sourceURL=../coffee/gate.coffee