// koffee 1.4.0
var Action, Actor, Camera, Material, ScreenText, Timer, Vector, klog,
    bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    extend = function(child, parent) { for (var key in parent) { if (hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; },
    hasProp = {}.hasOwnProperty;

klog = require('kxk').klog;

Camera = require('./camera');

Action = require('./action');

Timer = require('./timer');

Actor = require('./actor');

Vector = require('./lib/vector');

Material = require('./material');

ScreenText = (function(superClass) {
    extend(ScreenText, superClass);

    ScreenText.geomCache = {};

    ScreenText.letters = {};

    ScreenText.init = function() {
        var c, geom, i, len, max, min, ref, results;
        this.font = new THREE.Font(require('three/examples/fonts/helvetiker_bold.typeface.json'));
        ref = "abcdefghijklmnopqrstuvwxyz0123456789.,-+:'?/\\[]()<>!";
        results = [];
        for (i = 0, len = ref.length; i < len; i++) {
            c = ref[i];
            geom = new THREE.TextGeometry("" + c, {
                font: ScreenText.font,
                size: 1,
                height: 4,
                bevelEnabled: true,
                bevelThickness: 0.1,
                bevelSize: 0.04
            });
            geom.computeBoundingBox();
            min = geom.boundingBox.min;
            max = geom.boundingBox.max;
            results.push(this.letters[c] = {
                geom: geom,
                width: max.x - min.x,
                height: max.y - min.y
            });
        }
        return results;
    };

    function ScreenText(text, material) {
        var aspect, i, l, len, ref;
        this.text = text;
        if (material == null) {
            material = Material.text;
        }
        this.fadeOut = bind(this.fadeOut, this);
        ScreenText.__super__.constructor.apply(this, arguments);
        this.addAction(new Action(this, Action.SHOW, "show" + this.constructor.name, 500));
        this.addAction(new Action(this, Action.HIDE, "hide" + this.constructor.name, 500));
        this.scene = new THREE.Scene();
        if (this.lineHeight == null) {
            this.lineHeight = 1.3;
        }
        this.sun1 = new THREE.PointLight(0xffffff);
        this.scene.add(this.sun1);
        this.sun2 = new THREE.PointLight(0xffffff);
        this.scene.add(this.sun2);
        this.height = 0;
        this.width = 0;
        this.cameraOffset = 1;
        this.mesh = new THREE.Object3D;
        this.scene.add(this.mesh);
        aspect = world.screenSize.w / world.screenSize.h;
        this.camera = new THREE.PerspectiveCamera(20, aspect, 1, 1000);
        if (this.text != null) {
            ref = this.text.split('\n');
            for (i = 0, len = ref.length; i < len; i++) {
                l = ref[i];
                this.addText(l, 1, material);
            }
            this.show();
        }
    }

    ScreenText.prototype.del = function() {
        this.scene.remove(this.mesh);
        this.scene.remove(this.sun1);
        this.scene.remove(this.sun2);
        Timer.removeActionsOfObject(this);
        if (world.text === this) {
            world.text = null;
            return world.helpShown = false;
        }
    };

    ScreenText.prototype.show = function() {
        return this.startTimedAction(this.getActionWithId(Action.SHOW));
    };

    ScreenText.prototype.addText = function(str, scaleFactor, material) {
        var c, group, i, len, letter, mesh, x, z;
        if (scaleFactor == null) {
            scaleFactor = 1;
        }
        if (material == null) {
            material = Material.text;
        }
        if (str.trim().length === 0) {
            this.height += 1;
            return;
        }
        x = 0;
        group = new THREE.Group;
        for (i = 0, len = str.length; i < len; i++) {
            c = str[i];
            c = c.toLowerCase();
            if (letter = ScreenText.letters[c]) {
                mesh = new THREE.Mesh(letter.geom, material);
                mesh.translateX(x);
                x += letter.width + 0.06;
                group.add(mesh);
            } else {
                x += 0.5;
            }
        }
        this.width = Math.max(this.width, x);
        group.translateX(-x / 2 * scaleFactor);
        group.translateY(-this.height * this.lineHeight * scaleFactor);
        group.scale.set(scaleFactor, scaleFactor, scaleFactor);
        this.mesh.add(group);
        this.mesh.position.set(0, this.height / 2 * this.lineHeight, 0);
        z = 20 + 4 * this.height;
        z = Math.max(z, parseInt(this.width * 4));
        this.cameraOffset = Math.max(this.cameraOffset, z);
        this.camera.position.copy(new Vector(0, 0, this.cameraOffset));
        this.sun1.position.set(-this.cameraOffset / 5, this.cameraOffset / 5, this.cameraOffset);
        this.sun2.position.set(this.cameraOffset / 5, this.cameraOffset / 5, this.cameraOffset);
        this.camera.lookAt(new THREE.Vector3(0, 0, 0));
        return this.height += 1;
    };

    ScreenText.prototype.setOpacity = function(o) {
        return this.mesh.traverse(function(c) {
            var ref;
            return (ref = c.material) != null ? ref.opacity = o : void 0;
        });
    };

    ScreenText.prototype.resized = function(w, h) {
        this.camera.aspect = w / h;
        return this.camera.updateProjectionMatrix();
    };

    ScreenText.prototype.performAction = function(action) {
        switch (action.id) {
            case Action.SHOW:
                return this.setOpacity(action.getRelativeTime());
            case Action.HIDE:
                return this.setOpacity(1 - action.getRelativeTime());
        }
    };

    ScreenText.prototype.actionFinished = function(action) {
        switch (action.id) {
            case Action.HIDE:
                return this.del();
            case Action.SHOW:
                return this.setOpacity(1);
        }
    };

    ScreenText.prototype.fadeOut = function() {
        if (this.fadingOut) {
            return;
        }
        this.fadingOut = true;
        this.stopAction(this.getActionWithId(Action.SHOW));
        return this.startTimedAction(this.getActionWithId(Action.HIDE));
    };

    return ScreenText;

})(Actor);

module.exports = ScreenText;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2NyZWVudGV4dC5qcyIsInNvdXJjZVJvb3QiOiIuIiwic291cmNlcyI6WyIiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQU9BLElBQUEsZ0VBQUE7SUFBQTs7OztBQUFFLE9BQVMsT0FBQSxDQUFRLEtBQVI7O0FBQ1gsTUFBQSxHQUFXLE9BQUEsQ0FBUSxVQUFSOztBQUNYLE1BQUEsR0FBVyxPQUFBLENBQVEsVUFBUjs7QUFDWCxLQUFBLEdBQVcsT0FBQSxDQUFRLFNBQVI7O0FBQ1gsS0FBQSxHQUFXLE9BQUEsQ0FBUSxTQUFSOztBQUNYLE1BQUEsR0FBVyxPQUFBLENBQVEsY0FBUjs7QUFDWCxRQUFBLEdBQVcsT0FBQSxDQUFRLFlBQVI7O0FBRUw7OztJQUVGLFVBQUMsQ0FBQSxTQUFELEdBQVk7O0lBRVosVUFBQyxDQUFBLE9BQUQsR0FBVTs7SUFFVixVQUFDLENBQUEsSUFBRCxHQUFPLFNBQUE7QUFFSCxZQUFBO1FBQUEsSUFBQyxDQUFBLElBQUQsR0FBUSxJQUFJLEtBQUssQ0FBQyxJQUFWLENBQWUsT0FBQSxDQUFRLG9EQUFSLENBQWY7QUFFUjtBQUFBO2FBQUEscUNBQUE7O1lBRUksSUFBQSxHQUFPLElBQUksS0FBSyxDQUFDLFlBQVYsQ0FBdUIsRUFBQSxHQUFHLENBQTFCLEVBQ0g7Z0JBQUEsSUFBQSxFQUFNLFVBQVUsQ0FBQyxJQUFqQjtnQkFDQSxJQUFBLEVBQU0sQ0FETjtnQkFFQSxNQUFBLEVBQVEsQ0FGUjtnQkFHQSxZQUFBLEVBQWMsSUFIZDtnQkFJQSxjQUFBLEVBQWdCLEdBSmhCO2dCQUtBLFNBQUEsRUFBVyxJQUxYO2FBREc7WUFRUCxJQUFJLENBQUMsa0JBQUwsQ0FBQTtZQUNBLEdBQUEsR0FBTSxJQUFJLENBQUMsV0FBVyxDQUFDO1lBQ3ZCLEdBQUEsR0FBTSxJQUFJLENBQUMsV0FBVyxDQUFDO3lCQUV2QixJQUFDLENBQUEsT0FBUSxDQUFBLENBQUEsQ0FBVCxHQUNJO2dCQUFBLElBQUEsRUFBTSxJQUFOO2dCQUNBLEtBQUEsRUFB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QUFBLGlCQUNTLE1BQU0sQ0FBQyxJQURoQjt1QkFFUSxJQUFDLENBQUEsVUFBRCxDQUFZLE1BQU0sQ0FBQyxlQUFQLENBQUEsQ0FBWjtBQUZSLGlCQUdTLE1BQU0sQ0FBQyxJQUhoQjt1QkFJUSxJQUFDLENBQUEsVUFBRCxDQUFZLENBQUEsR0FBSSxNQUFNLENBQUMsZUFBUCxDQUFBLENBQWhCO0FBSlI7SUFGVzs7eUJBUWYsY0FBQSxHQUFnQixTQUFDLE1BQUQ7QUFFWixnQkFBTyxNQUFNLENBQUMsRUFBZDtBQUFBLGlCQUNTLE1BQU0sQ0FBQyxJQURoQjt1QkFFUSxJQUFDLENBQUEsR0FBRCxDQUFBO0FBRlIsaUJBR1MsTUFBTSxDQUFDLElBSGhCO3VCQUlRLElBQUMsQ0FBQSxVQUFELENBQVksQ0FBWjtBQUpSO0lBRlk7O3lCQVFoQixPQUFBLEdBQVMsU0FBQTtRQUVMLElBQVUsSUFBQyxDQUFBLFNBQVg7QUFBQSxtQkFBQTs7UUFDQSxJQUFDLENBQUEsU0FBRCxHQUFhO1FBQ2IsSUFBQyxDQUFBLFVBQUQsQ0FBWSxJQUFDLENBQUEsZUFBRCxDQUFpQixNQUFNLENBQUMsSUFBeEIsQ0FBWjtlQUNBLElBQUMsQ0FBQSxnQkFBRCxDQUFrQixJQUFDLENBQUEsZUFBRCxDQUFpQixNQUFNLENBQUMsSUFBeEIsQ0FBbEI7SUFMSzs7OztHQW5JWTs7QUEwSXpCLE1BQU0sQ0FBQyxPQUFQLEdBQWlCIiwic291cmNlc0NvbnRlbnQiOlsiXG4jICAgIDAwMDAwMDAgICAwMDAwMDAwICAwMDAwMDAwMCAgIDAwMDAwMDAwICAwMDAwMDAwMCAgMDAwICAgMDAwICAwMDAwMDAwMDAgIDAwMDAwMDAwICAwMDAgICAwMDAgIDAwMDAwMDAwMFxuIyAgIDAwMCAgICAgICAwMDAgICAgICAgMDAwICAgMDAwICAwMDAgICAgICAgMDAwICAgICAgIDAwMDAgIDAwMCAgICAgMDAwICAgICAwMDAgICAgICAgIDAwMCAwMDAgICAgICAwMDAgICBcbiMgICAwMDAwMDAwICAgMDAwICAgICAgIDAwMDAwMDAgICAgMDAwMDAwMCAgIDAwMDAwMDAgICAwMDAgMCAwMDAgICAgIDAwMCAgICAgMDAwMDAwMCAgICAgMDAwMDAgICAgICAgMDAwICAgXG4jICAgICAgICAwMDAgIDAwMCAgICAgICAwMDAgICAwMDAgIDAwMCAgICAgICAwMDAgICAgICAgMDAwICAwMDAwICAgICAwMDAgICAgIDAwMCAgICAgICAgMDAwIDAwMCAgICAgIDAwMCAgIFxuIyAgIDAwMDAwMDAgICAgMDAwMDAwMCAgMDAwICAgMDAwICAwMDAwMDAwMCAgMDAwMDAwMDAgIDAwMCAgIDAwMCAgICAgMDAwICAgICAwMDAwMDAwMCAgMDAwICAgMDAwICAgICAwMDAgICBcblxueyBrbG9nIH0gPSByZXF1aXJlICdreGsnXG5DYW1lcmEgICA9IHJlcXVpcmUgJy4vY2FtZXJhJ1xuQWN0aW9uICAgPSByZXF1aXJlICcuL2FjdGlvbidcblRpbWVyICAgID0gcmVxdWlyZSAnLi90aW1lcidcbkFjdG9yICAgID0gcmVxdWlyZSAnLi9hY3RvcidcblZlY3RvciAgID0gcmVxdWlyZSAnLi9saWIvdmVjdG9yJ1xuTWF0ZXJpYWwgPSByZXF1aXJlICcuL21hdGVyaWFsJ1xuXG5jbGFzcyBTY3JlZW5UZXh0IGV4dGVuZHMgQWN0b3IgICAgXG4gICAgXG4gICAgQGdlb21DYWNoZToge31cbiAgICBcbiAgICBAbGV0dGVyczoge31cbiAgICBcbiAgICBAaW5pdDogLT4gXG4gICAgICAgIFxuICAgICAgICBAZm9udCA9IG5ldyBUSFJFRS5Gb250IHJlcXVpcmUgJ3RocmVlL2V4YW1wbGVzL2ZvbnRzL2hlbHZldGlrZXJfYm9sZC50eXBlZmFjZS5qc29uJ1xuICAgICAgICBcbiAgICAgICAgZm9yIGMgaW4gXCJhYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ejAxMjM0NTY3ODkuLC0rOic/L1xcXFxbXSgpPD4hXCJcblxuICAgICAgICAgICAgZ2VvbSA9IG5ldyBUSFJFRS5UZXh0R2VvbWV0cnkgXCIje2N9XCIsIFxuICAgICAgICAgICAgICAgIGZvbnQ6IFNjcmVlblRleHQuZm9udFxuICAgICAgICAgICAgICAgIHNpemU6IDFcbiAgICAgICAgICAgICAgICBoZWlnaHQ6IDRcbiAgICAgICAgICAgICAgICBiZXZlbEVuYWJsZWQ6IHRydWVcbiAgICAgICAgICAgICAgICBiZXZlbFRoaWNrbmVzczogMC4xXG4gICAgICAgICAgICAgICAgYmV2ZWxTaXplOiAwLjA0XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgZ2VvbS5jb21wdXRlQm91bmRpbmdCb3goKVxuICAgICAgICAgICAgbWluID0gZ2VvbS5ib3VuZGluZ0JveC5taW5cbiAgICAgICAgICAgIG1heCA9IGdlb20uYm91bmRpbmdCb3gubWF4XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgQGxldHRlcnNbY10gPSBcbiAgICAgICAgICAgICAgICBnZW9tOiBnZW9tXG4gICAgICAgICAgICAgICAgd2lkdGg6IG1heC54IC0gbWluLnhcbiAgICAgICAgICAgICAgICBoZWlnaHQ6IG1heC55IC0gbWluLnlcbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgIEA6IChAdGV4dCwgbWF0ZXJpYWw9TWF0ZXJpYWwudGV4dCkgLT5cbiAgICAgICAgXG4gICAgICAgIHN1cGVyXG4gICAgICAgIFxuICAgICAgICBAYWRkQWN0aW9uIG5ldyBBY3Rpb24gQCwgQWN0aW9uLlNIT1csIFwic2hvdyN7QGNvbnN0cnVjdG9yLm5hbWV9XCIgNTAwXG4gICAgICAgIEBhZGRBY3Rpb24gbmV3IEFjdGlvbiBALCBBY3Rpb24uSElERSwgXCJoaWRlI3tAY29uc3RydWN0b3IubmFtZX1cIiA1MDBcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgQHNjZW5lID0gbmV3IFRIUkVFLlNjZW5lKClcbiAgICAgICAgQGxpbmVIZWlnaHQgPSAxLjMgaWYgbm90IEBsaW5lSGVpZ2h0P1xuICAgICAgICAgICAgICAgIFxuICAgICAgICBAc3VuMSA9IG5ldyBUSFJFRS5Qb2ludExpZ2h0IDB4ZmZmZmZmXG4gICAgICAgIEBzY2VuZS5hZGQgQHN1bjFcblxuICAgICAgICBAc3VuMiA9IG5ldyBUSFJFRS5Qb2ludExpZ2h0IDB4ZmZmZmZmXG4gICAgICAgIEBzY2VuZS5hZGQgQHN1bjJcbiAgICAgICAgXG4gICAgICAgIEBoZWlnaHQgPSAwXG4gICAgICAgIEB3aWR0aCA9IDBcbiAgICAgICAgQGNhbWVyYU9mZnNldCA9IDFcbiAgICAgICAgQG1lc2ggPSBuZXcgVEhSRUUuT2JqZWN0M0RcbiAgICAgICAgQHNjZW5lLmFkZCBAbWVzaFxuICAgICAgICBhc3BlY3QgPSB3b3JsZC5zY3JlZW5TaXplLncvd29ybGQuc2NyZWVuU2l6ZS5oXG4gICAgICAgIEBjYW1lcmEgPSBuZXcgVEhSRUUuUGVyc3BlY3RpdmVDYW1lcmEgMjAsIGFzcGVjdCwgMSwgMTAwMFxuICAgICAgICBpZiBAdGV4dD9cbiAgICAgICAgICAgIGZvciBsIGluIEB0ZXh0LnNwbGl0ICdcXG4nXG4gICAgICAgICAgICAgICAgQGFkZFRleHQgbCwgMSwgbWF0ZXJpYWxcbiAgICAgICAgICAgIEBzaG93KClcbiAgICBcbiAgICBkZWw6IC0+XG4gICAgICAgIFxuICAgICAgICBAc2NlbmUucmVtb3ZlIEBtZXNoXG4gICAgICAgIEBzY2VuZS5yZW1vdmUgQHN1bjFcbiAgICAgICAgQHNjZW5lLnJlbW92ZSBAc3VuMlxuICAgICAgICBUaW1lci5yZW1vdmVBY3Rpb25zT2ZPYmplY3QgQFxuICAgICAgICBpZiB3b3JsZC50ZXh0ID09IEBcbiAgICAgICAgICAgIHdvcmxkLnRleHQgPSBudWxsIFxuICAgICAgICAgICAgd29ybGQuaGVscFNob3duID0gZmFsc2VcbiAgICBcbiAgICBzaG93OiAtPiBAc3RhcnRUaW1lZEFjdGlvbiBAZ2V0QWN0aW9uV2l0aElkIEFjdGlvbi5TSE9XXG4gICAgXG4gICAgYWRkVGV4dDogKHN0ciwgc2NhbGVGYWN0b3I9MSwgbWF0ZXJpYWw9TWF0ZXJpYWwudGV4dCkgLT5cbiAgICAgICAgXG4gICAgICAgIGlmIHN0ci50cmltKCkubGVuZ3RoID09IDBcbiAgICAgICAgICAgIEBoZWlnaHQgKz0gMVxuICAgICAgICAgICAgcmV0dXJuXG4gICAgICAgIFxuICAgICAgICB4ID0gMFxuICAgICAgICBncm91cCA9IG5ldyBUSFJFRS5Hcm91cFxuICAgICAgICBmb3IgYyBpbiBzdHJcbiAgICAgICAgICAgIGMgPSBjLnRvTG93ZXJDYXNlKClcbiAgICAgICAgICAgIGlmIGxldHRlciA9IFNjcmVlblRleHQubGV0dGVyc1tjXVxuICAgICAgICAgICAgICAgIG1lc2ggPSBuZXcgVEhSRUUuTWVzaCBsZXR0ZXIuZ2VvbSwgbWF0ZXJpYWxcbiAgICAgICAgICAgICAgICBtZXNoLnRyYW5zbGF0ZVggeFxuICAgICAgICAgICAgICAgIHggKz0gbGV0dGVyLndpZHRoICsgMC4wNlxuICAgICAgICAgICAgICAgIGdyb3VwLmFkZCBtZXNoXG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgeCArPSAwLjVcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgQHdpZHRoID0gTWF0aC5tYXggQHdpZHRoLCB4XG4gICAgICAgIGdyb3VwLnRyYW5zbGF0ZVggLXgvMiAqIHNjYWxlRmFjdG9yIFxuICAgICAgICBncm91cC50cmFuc2xhdGVZIC1AaGVpZ2h0ICogQGxpbmVIZWlnaHQgKiBzY2FsZUZhY3RvclxuICAgICAgICBncm91cC5zY2FsZS5zZXQgc2NhbGVGYWN0b3IsIHNjYWxlRmFjdG9yLCBzY2FsZUZhY3RvclxuICAgICAgICBAbWVzaC5hZGQgZ3JvdXBcbiAgICAgICAgICAgIFxuICAgICAgICBAbWVzaC5wb3NpdGlvbi5zZXQgMCwgQGhlaWdodC8yKkBsaW5lSGVpZ2h0LCAwXG4gICAgICAgIFxuICAgICAgICAjIGFkanVzdCBwcm9qZWN0aW9uXG4gICAgICAgIHogPSAyMCs0KkBoZWlnaHRcbiAgICAgICAgeiA9IE1hdGgubWF4IHosIHBhcnNlSW50IEB3aWR0aCo0XG5cbiAgICAgICAgQGNhbWVyYU9mZnNldCA9IE1hdGgubWF4IEBjYW1lcmFPZmZzZXQsIHpcbiAgICAgICAgQGNhbWVyYS5wb3NpdGlvbi5jb3B5IG5ldyBWZWN0b3IgMCAwIEBjYW1lcmFPZmZzZXRcbiAgICAgICAgQHN1bjEucG9zaXRpb24uc2V0IC1AY2FtZXJhT2Zmc2V0LzUgQGNhbWVyYU9mZnNldC81IEBjYW1lcmFPZmZzZXRcbiAgICAgICAgQHN1bjIucG9zaXRpb24uc2V0ICBAY2FtZXJhT2Zmc2V0LzUgQGNhbWVyYU9mZnNldC81IEBjYW1lcmFPZmZzZXRcbiAgICAgICAgQGNhbWVyYS5sb29rQXQgbmV3IFRIUkVFLlZlY3RvcjMgMCAwIDBcbiAgICAgICAgQGhlaWdodCArPSAxXG5cbiAgICBzZXRPcGFjaXR5OiAobykgLT5cbiAgICAgICAgXG4gICAgICAgIEBtZXNoLnRyYXZlcnNlIChjKSAtPiBjLm1hdGVyaWFsPy5vcGFjaXR5ID0gb1xuICAgICAgICAgICAgXG4gICAgcmVzaXplZDogKHcsaCkgLT5cbiAgICAgICAgXG4gICAgICAgIEBjYW1lcmEuYXNwZWN0ID0gdy9oXG4gICAgICAgIEBjYW1lcmEudXBkYXRlUHJvamVjdGlvbk1hdHJpeCgpXG4gICAgXG4gICAgcGVyZm9ybUFjdGlvbjogKGFjdGlvbikgLT5cbiAgICAgICAgXG4gICAgICAgIHN3aXRjaCBhY3Rpb24uaWRcbiAgICAgICAgICAgIHdoZW4gQWN0aW9uLlNIT1dcbiAgICAgICAgICAgICAgICBAc2V0T3BhY2l0eSBhY3Rpb24uZ2V0UmVsYXRpdmVUaW1lKClcbiAgICAgICAgICAgIHdoZW4gQWN0aW9uLkhJREVcbiAgICAgICAgICAgICAgICBAc2V0T3BhY2l0eSAxIC0gYWN0aW9uLmdldFJlbGF0aXZlVGltZSgpXG4gICAgXG4gICAgYWN0aW9uRmluaXNoZWQ6IChhY3Rpb24pIC0+XG4gICAgICAgIFxuICAgICAgICBzd2l0Y2ggYWN0aW9uLmlkXG4gICAgICAgICAgICB3aGVuIEFjdGlvbi5ISURFXG4gICAgICAgICAgICAgICAgQGRlbCgpXG4gICAgICAgICAgICB3aGVuIEFjdGlvbi5TSE9XXG4gICAgICAgICAgICAgICAgQHNldE9wYWNpdHkgMVxuICAgICAgICAgICAgXG4gICAgZmFkZU91dDogPT4gXG4gICAgICAgIFxuICAgICAgICByZXR1cm4gaWYgQGZhZGluZ091dFxuICAgICAgICBAZmFkaW5nT3V0ID0gdHJ1ZVxuICAgICAgICBAc3RvcEFjdGlvbiBAZ2V0QWN0aW9uV2l0aElkIEFjdGlvbi5TSE9XXG4gICAgICAgIEBzdGFydFRpbWVkQWN0aW9uIEBnZXRBY3Rpb25XaXRoSWQgQWN0aW9uLkhJREVcbiAgICBcbm1vZHVsZS5leHBvcnRzID0gU2NyZWVuVGV4dFxuICAgICJdfQ==
//# sourceURL=../coffee/screentext.coffee